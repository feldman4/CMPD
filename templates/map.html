<!DOCTYPE html>
<html>
<head>
	<title>Map</title>

    <script type="text/javascript" src="/static/fuse.js"></script>
    <script type="text/javascript" src="/static/socket.io.min.js"></script>
    <script type="text/javascript" src="/static/underscore-min.js"></script>
    <script type="text/javascript" src="/static/elm-helpers.js"></script>

    <!-- needs native alternative to $.getScript -->
    <script src="https://code.jquery.com/jquery-3.0.0.min.js" integrity="sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0=" crossorigin="anonymous"></script>

    <script src="/static/jquery-3.0.0.min.js" integrity="sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0=" crossorigin="anonymous"></script>

    <link href="/static/main.css" rel="stylesheet">
    <link href="/static/menu.css" rel="stylesheet">

    <title></title>
</head>
<body>
    <script>
    	// Elm js hosted remotely for compatibility with Heroku...
    	var local_elm_js = "/static/Map.js"
    	var hosted_elm_js = "https://drive.google.com/uc?export=download&id=0B3flOzQHFe1mUFNpekI4QUVxdnM"

		var app 
		var socketRoom = '/map'

		var map = {{map | safe}}

		function launchElm(){
			app = Elm.Map.fullscreen()

			// register communication to/from elm, flask
			
			//// FLASK -> ELM ////
        	updateWordbank(app)
            remark(app)
            changeEnemy(app)

            //// ELM -> FLASK ////
            sendInsult(app)
            requestEncounter(app)
            sendEncounter(app)

            //// ELM -> JS    ////
            scrollTop(app)
            askFuse(app)

			setTimeout(function(){ 

	            app.ports.setMap.send(map)

	            }
	            ,	0
	        );
		}

		$(document).ready(function() {

				documentReady(socketRoom)
		        getScriptLocalHosted(local_elm_js, hosted_elm_js, launchElm)

		    }
		)

    </script>
</body>
</html>
